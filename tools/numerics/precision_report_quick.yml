run_id: "gpt-numerics-v1"
reference: { device: cpu, dtype: fp32, compile: false }
devices: [cpu, mps]
compile_modes: [false, true]
dtype_policies: [fp32, bf16, fp16, autocast_bf16]

dataset:
  shard_pattern: "data/fineweb/fineweb_train_000001.bin"  # or: path: "prompts.jsonl"
  max_prompts: 4
  length_buckets: [4] #64

decoding:
  mode_open_loop: { enabled: true }
  mode_closed_loop: { enabled: true, max_new_tokens: 8 }

outputs:
  root: "./artifacts_root/quick"
  write_parquet: true